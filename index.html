<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Проверка доступа</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="noindex, follow">
  <meta name="yandex-verification" content="c9adacc91d7194c6">
  <link rel="canonical" href="https://v2raytun.de/home.html">
  <meta name="color-scheme" content="dark">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
  <!-- опционально прелоад одного из флагов -->
  <link rel="preload" as="image" href="assets/flags/germany.png">
  <style>
    :root{--bg:#0d1117;--fg:#fff;--ring:#fff;--error:#ff3b3b;--r:8px;--rs:6px;--t:.2s}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;min-height:100dvh;display:flex;align-items:center;justify-content:center;text-align:center}
    .wrap{max-width:880px;padding:16px}
    .title{margin:0 0 18px;font-weight:700;line-height:1.32;font-size:22px}
    #flagTarget{margin:14px 0 18px}
    .sample{border:2px solid var(--ring);border-radius:var(--r);transform:rotate(.5turn)}
    #flagOptions{display:flex;gap:14px;flex-wrap:wrap;justify-content:center}
    .option{width:70px;height:48px;border-radius:var(--rs);border:2px solid transparent;cursor:pointer;transition:transform var(--t),border-color var(--t)}
    .option:hover,.option:focus-visible{transform:scale(1.05);outline:none;border-color:#6ea8fe}
    @keyframes blink{0%,100%{border-color:transparent}10%,90%{border-color:var(--error)}}
    .wrong{animation:blink .6s linear 1}
    .fallback{margin-top:14px}
    .fallback a{color:#fff;text-decoration:underline;font-weight:600}
    noscript{display:block;margin-top:10px}
    /* если захочешь «почти скрыть» ссылку — раскомментируй sr-only
    .sr-only{position:absolute !important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    */
  </style>
</head>
<body>
  <div class="wrap">
    <h2 class="title">Нужно подтвердить, что вы человек.<br>Выберите картинку, совпадающую с образцом флага:</h2>

    <!-- РЕКОМЕНДУЕМАЯ видимая ссылка для людей и робота -->
    <p class="fallback">Если проверка недоступна, откройте основную страницу: <a href="home.html">home.html</a></p>
    <!-- Если очень хочешь её «убрать» визуально — добавь классу <p> класс sr-only (см. CSS выше). -->

    <div id="flagTarget" aria-live="polite"></div>
    <div id="flagOptions" role="group" aria-label="Варианты флагов"></div>

    <noscript>Для продолжения включите JavaScript или перейдите на <a href="home.html">home.html</a>.</noscript>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const FLAGS = [
        { name: "canada",      src: "assets/flags/canada.png" },
        { name: "uk",          src: "assets/flags/uk.png" },
        { name: "moldova",     src: "assets/flags/moldova.png" },
        { name: "south_korea", src: "assets/flags/south_korea.png" },
        { name: "japan",       src: "assets/flags/japan.png" },
        { name: "germany",     src: "assets/flags/germany.png" }
      ];

      const $target  = document.getElementById("flagTarget");
      const $options = document.getElementById("flagOptions");

      function rint(max){
        try{
          if (window.crypto && window.crypto.getRandomValues){
            const a = new Uint32Array(1);
            window.crypto.getRandomValues(a);
            return a[0] % max;
          }
        }catch(e){}
        return Math.floor(Math.random() * max);
      }

      function shuffle(arr){
        const a = arr.slice();
        for (let i = a.length - 1; i > 0; i--){
          const j = rint(i + 1);
          const t = a[i]; a[i] = a[j]; a[j] = t;
        }
        return a;
      }

      // образец
      const correct = FLAGS[rint(FLAGS.length)];
      const sample = new Image();
      sample.className = "sample";
      sample.src = correct.src;
      sample.alt = "Образец флага";
      sample.width = 110; sample.height = 70;
      sample.decoding = "async"; sample.loading = "eager";
      sample.onerror = () => { sample.remove(); $target.textContent = "Не удалось загрузить образец флага."; };
      $target.appendChild(sample);

      // варианты
      for (const flag of shuffle(FLAGS)){
        const img = new Image();
        img.className = "option";
        img.src = flag.src;
        img.alt = "Вариант флага";
        img.decoding = "async";
        img.loading = "lazy";
        img.tabIndex = 0;
        img.setAttribute("role","button");
        img.setAttribute("aria-label","Выбрать флаг");

        const choose = () => {
          if (flag.name === correct.name) {
            location.href = "home.html";
          } else {
            img.classList.remove("wrong"); void img.offsetWidth; img.classList.add("wrong");
          }
        };
        img.addEventListener("click", choose);
        img.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") { e.preventDefault(); choose(); }
        });
        img.onerror = () => { img.remove(); };

        $options.appendChild(img);
      }
    });
  </script>

  <!-- Yandex.Metrika -->
  <script>
    (function(m,e,t,r,i,k,a){
      m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
      m[i].l=1*new Date();
      for (var j=0;j<document.scripts.length;j++){ if (document.scripts[j].src===r){ return; } }
      k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window,document,'script','https://mc.yandex.ru/metrika/tag.js?id=105570211','ym');
    ym(105570211,'init',{ssr:true,webvisor:true,clickmap:true,ecommerce:"dataLayer",accurateTrackBounce:true,trackLinks:true});
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/105570211" style="position:absolute;left:-9999px" alt=""></div></noscript>
  <!-- /Yandex.Metrika -->
</body>
</html>


